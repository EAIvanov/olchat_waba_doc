# Отправка шаблона сообщения с кнопками и обработка ответов роботом Ожидание сообщения

В процессе взаимодействия с клиентом на любом этапе сделки может происходить отправка клиенту сообщений в WhatsApp и получение от него ответов. Если вопросы задаваемые клиенту всегда одинаковые, а ответы получаемые от клиента однотипные, этот процесс можно автоматизировать с помощью роботов [otpravit-soobshenie-ili-shablon.md](../roboty-i-aktiviti/roboty-i-aktiviti-biznes-processov/otpravit-soobshenie-ili-shablon.md "mention") и [ozhidat-soobshenie.md](../roboty-i-aktiviti/roboty-i-aktiviti-biznes-processov/ozhidat-soobshenie.md "mention")

Рассмотрим следующий сценарий:

1. Отправляем клиенту в WhatsApp сообщение. В тексте сообщения используем заранее согласованный шаблон с добавлением кнопок. Ожидаем ответ клиента.
2. Обрабатываем ответ клиента и реагируем соответствующим образом: либо отправляем клиенту ещё несколько сообщений, либо ставим на ответственного по сделке Дело позвонить клиенту.

Выполним пошаговую настройку описанного выше сценария.

На стадию **«Отправлено приглашение»** добавим робота **«\[Whatsabi] Отправить сообщение»,** в котором с помощью заранее утверждённого шаблонного сообщения с кнопками уведомим клиента о предстоящей акции и предоставим на выбор возможность записаться на процедуру или узнать подробнее об акции.

<figure><img src="../.gitbook/assets/image (253).png" alt=""><figcaption></figcaption></figure>

Выполните настройку робота. Для этого на добавленном роботе нажмите на кнопку «изменить», чтобы открыть интерфейс редактирования робота.

<figure><img src="../.gitbook/assets/image (20).png" alt=""><figcaption></figcaption></figure>

1. Укажите **Линию WhatsApp,** через которую планируете сделать отправку
2. Введите **Номер телефона**, на который необходимо отправить сообщение
3. В поле **«Сообщение»** напишите текст. В рассматриваемом примере – это текст шаблона сообщения. Как его получить подробнее рассмотрено в статье [poluchenie-parametrov-shablonov.md](../vozmozhnosti/poluchenie-parametrov-shablonov.md "mention")

Нажмите на кнопку «СОХРАНИТЬ».

Шаблонное сообщение, полученное клиентом в WhatsApp имеет следующий вид:

<figure><img src="../.gitbook/assets/image (269).png" alt=""><figcaption></figcaption></figure>

Далее, для ожидания вариантов ответа клиента на текущую стадию добавим робота **«\[Whatsabi] Ожидать сообщение».**

<figure><img src="../.gitbook/assets/image (255).png" alt=""><figcaption></figcaption></figure>

Выполним настройку робота. Для этого на добавленном роботе нажмите на кнопку «изменить», чтобы открыть интерфейс редактирования робота.

Робот **«Ожидать сообщения»** позволяет дождаться ответа пользователя на ваше сообщение. Ответ пользователя содержится в дополнительных результатах робота. Мы отправили клиенту шаблон сообщения с кнопками и ожидаем получить варианты: «Записаться на процедуру» и «Узнать подробнее об акции».

Настроим добавленного робота

1. Обязательно укажите, что робот должен сработать **после предыдущего**
2. Выберите **Линию WhatsApp,** для которой ожидаем сообщение
3. Введите **Номер телефона** клиента, на который было отправлено сообщение и с которого мы ожидаем получить ответ
4. Укажите **Период ожидания (в минутах),** в течение которого робот будет ожидать сообщение от клиента

<figure><img src="../.gitbook/assets/image (19).png" alt=""><figcaption></figcaption></figure>

Нажмите на кнопку «СОХРАНИТЬ».

Далее, необходимо обработать ответ клиента.&#x20;

Если клиент выбрал кнопку «Узнать подробнее об акции» – переведём сделку в стадию «Отправлена форма для записи». В данной стадии вы можете добавить ещё одного робота, который, например, отправит клиенту сообщение с ссылкой на форму записи на процедуру.

Добавим робота **«Сменить стадию»** и выполним его настройку.

<figure><img src="../.gitbook/assets/image (257).png" alt=""><figcaption></figcaption></figure>

1. Обязательно укажите, что робот должен сработать **после предыдущего**
2.  Настроим условие срабатывания робота. Для этого необходимо обработать ответ пользователя, содержащийся в дополнительных результатах робота «Ожидание сообщения»\


    <figure><img src="../.gitbook/assets/image (261).png" alt=""><figcaption></figcaption></figure>

    <figure><img src="../.gitbook/assets/image (263).png" alt=""><figcaption></figcaption></figure>

3\. Укажите стадию, на которую нужно изменить сделку

<figure><img src="../.gitbook/assets/image (264).png" alt=""><figcaption></figcaption></figure>

Нажмите на кнопку «СОХРАНИТЬ».

Последним шагом, добавим робота **«Запланировать дело»** и настроим его таким образом, чтобы он поставил на ответственного по сделке дело «Позвонить клиенту» в случае, если клиент выбрал кнопку «Узнать подробнее об акции» или не ответил в указанный промежуток времени.

<figure><img src="../.gitbook/assets/image (265).png" alt=""><figcaption></figcaption></figure>

Выполним настройку робота. Для этого на добавленном роботе нажмите на кнопку «изменить», чтобы открыть интерфейс редактирования робота.

1. Обязательно укажите, что робот должен сработать **после предыдущего**
2. Настроим условие срабатывания робота. Для этого необходимо обработать ответ пользователя, содержащийся в дополнительных результатах робота «Ожидание сообщения». Здесь мы можем обработать ответ «Нет» и тот случай, если клиент не ответил в указанный промежуток времени.

<figure><img src="../.gitbook/assets/image (267).png" alt=""><figcaption></figcaption></figure>

Нажмите на кнопку «СОХРАНИТЬ».
